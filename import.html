<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Import Job • CrewOS</title>
    <style>
      :root { color-scheme: light dark; }
      body { font-family: -apple-system, BlinkMacSystemFont, Segoe UI, Roboto, Helvetica, Arial, sans-serif; margin: 0; padding: 24px; }
      .card { max-width: 700px; margin: 0 auto; padding: 24px; border: 1px solid rgba(0,0,0,0.1); border-radius: 16px; }
      h1 { margin: 0 0 8px; font-size: 24px; }
      p { margin: 8px 0; line-height: 1.5; }
      code { background: rgba(0,0,0,0.06); padding: 2px 6px; border-radius: 6px; }
      .actions { margin-top: 16px; display: flex; gap: 12px; flex-wrap: wrap; }
      .btn { display: inline-block; padding: 12px 16px; border-radius: 10px; text-decoration: none; font-weight: 600; }
      .primary { background: #007aff; color: #fff; }
      .ghost { border: 1px solid rgba(0,0,0,0.15); color: inherit; }
      .muted { opacity: 0.7; }
    </style>
    <script>
      (function () {
        function getToken() {
          var qp = new URLSearchParams(location.search);
          var t = qp.get('token');
          if (t) return t;
          // Optional path support: /import/job/<token>
          var parts = location.pathname.split('/').filter(Boolean);
          if (parts.length >= 3 && parts[0] === 'import' && parts[1] === 'job') {
            return parts[2];
          }
          return '';
        }
        var token = getToken();
        var appUrl = token ? 'crewos://import/job/' + token : 'crewos://import';

        // Try to open the app shortly after page load
        setTimeout(function () { window.location.href = appUrl; }, 150);

        // Wire fallback button and show token
        window.addEventListener('DOMContentLoaded', function () {
          var tokenEl = document.getElementById('token');
          if (tokenEl && token) tokenEl.textContent = token;
          var openBtn = document.getElementById('open-app');
          if (openBtn) openBtn.href = appUrl;
        });
      })();
    </script>
  </head>
  <body>
    <div class="card">
      <h1>Open in CrewOS</h1>
      <p>We’re opening the CrewOS app to import this job for you.</p>
      <p class="muted">Token: <code id="token">(detecting)</code></p>
      <div class="actions">
        <a id="open-app" class="btn primary" href="#">Open in CrewOS</a>
        <!-- TODO: replace with your real App Store URL when available -->
        <a class="btn ghost" href="https://apps.apple.com/app/id000000000" target="_blank" rel="noopener">Get the app (iOS)</a>
      </div>
      <p class="muted">If nothing happens, tap “Open in CrewOS”. On desktop, open this link on your phone.</p>
    </div>
  </body>
</html>
